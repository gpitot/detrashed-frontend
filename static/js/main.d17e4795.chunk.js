(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{40:function(e,t,n){e.exports=n(55)},48:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(20),c=n.n(o),i=n(58),s=n(5),u=n(6),l=n(14),p=n(13),h=n(15),d=n(60),f=n(61),m=n(2),v=n.n(m),g=n(11),b=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"sendGetRequest",value:function(){var e=Object(g.a)(v.a.mark(function e(t){var n,a,r,o=arguments;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=o.length>1&&void 0!==o[1]?o[1]:null)&&(n={Accept:"application/json, text/plain, */*","Content-Type":"application/json"}),console.log(n),e.prev=3,e.next=6,fetch(t,{method:"get",headers:n});case 6:if(a=e.sent,!a.headers.get("content-type").includes("application/json")){e.next=13;break}return e.next=11,a.json();case 11:return r=e.sent,e.abrupt("return",r);case 13:return e.abrupt("return",a.text());case 16:return e.prev=16,e.t0=e.catch(3),console.log(e.t0),e.abrupt("return",{err:e.t0});case 20:case"end":return e.stop()}},e,null,[[3,16]])}));return function(t){return e.apply(this,arguments)}}()},{key:"sendPostRequest",value:function(){var e=Object(g.a)(v.a.mark(function e(t,n){var a,r,o,c=arguments;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null===(a=c.length>2&&void 0!==c[2]?c[2]:null)&&(a={"Content-Type":"application/json"}),e.prev=2,e.next=5,fetch(t,{method:"post",headers:a,body:JSON.stringify(n)});case 5:return r=e.sent,e.next=8,r.json();case 8:return o=e.sent,e.abrupt("return",o);case 12:return e.prev=12,e.t0=e.catch(2),e.abrupt("return",{err:e.t0});case 15:case"end":return e.stop()}},e,null,[[2,12]])}));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),k="https://detrashed-backend.herokuapp.com",O=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"sendLoginRequest",value:function(){var e=Object(g.a)(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b.sendGetRequest("".concat(k,"/user/login/")));case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"getTokens",value:function(){var e=Object(g.a)(v.a.mark(function e(t){var n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={code:t},e.abrupt("return",b.sendPostRequest("".concat(k,"/user/access/"),n));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),j=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){console.log("hello");var e=new URLSearchParams(window.location.search).get("code");e&&this.getTokens(e)}},{key:"getTokens",value:function(){var e=Object(g.a)(v.a.mark(function e(t){var n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,O.getTokens(t);case 3:n=e.sent,console.log(n),n.access_token?this.setLocalSession(n):localStorage.getItem("access_token")&&localStorage.getItem("refresh_token")?window.location="".concat("/detrashed-frontend","/"):window.location="".concat("/detrashed-frontend","/error");case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setLocalSession",value:function(e){localStorage.setItem("access_token",e.access_token),localStorage.setItem("refresh_token",e.refresh_token);var t=(new Date).getTime()+1e3*e.expires_in;localStorage.setItem("expiry_epoch",t),window.location="".concat("/detrashed-frontend","/")}},{key:"render",value:function(){return"Loading..."}}]),t}(r.a.Component),y=n(7),x=n(37),w=n(8),E=(n(48),n(59)),C=n(62),S=n(57),_=n(63);function T(){var e=Object(y.a)([""]);return T=function(){return e},e}function z(){var e=Object(y.a)(["\n    max-width: 100%;\n\n\n"]);return z=function(){return e},e}function L(){var e=Object(y.a)(["\n    text-align:center;\n    color:black;\n"]);return L=function(){return e},e}function I(){var e=Object(y.a)(["\n    display:flex;\n    flex-direction:column;\n    padding:25px;\n    overflow: hidden;\n"]);return I=function(){return e},e}var R=w.a.div(I()),D=w.a.a(L()),q=w.a.div(z()),P=w.a.div(T()),A=function(e){var t=e.event;return r.a.createElement(R,null,r.a.createElement(D,{href:t.url},t.name.text),r.a.createElement(q,null,t.description.text),r.a.createElement(P,null))},U=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={lat:51.505,lng:-.09,zoom:4},n.handleClick=function(e){console.log("clicked map",e)},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=[this.state.lat,this.state.lng];return r.a.createElement(E.a,{center:e,zoom:this.state.zoom,style:{height:"100vh",zIndex:1},onClick:this.props.handleClick},r.a.createElement(C.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png"}),this.props.events.map(function(e){if(null===e.venue)return null;var t=[e.venue.address.latitude,e.venue.address.longitude];return r.a.createElement(S.a,{position:t,key:e.id},r.a.createElement(_.a,null,r.a.createElement(A,{event:e})))}))}}]),t}(a.Component),B=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"linkButtonClicked",value:function(){O.sendLoginRequest().then(function(e){window.location=e}).catch(console.log)}}]),e}();function M(){var e=Object(y.a)(["\n    position:absolute;\n    top:50%;\n    left:50%;\n    transform:translate(-50%, -50%);\n    z-index:5;\n    padding:20px;\n    background:#eee;\n    border:solid 1px #2f2f2f;\n    color:#2f2f2f;\n    border-radius:4px;\n    font-size:24px;\n    cursor:pointer;\n    &:hover {\n        background:#2f2f2f;\n        color:#eee;\n    }\n"]);return M=function(){return e},e}function H(){var e=Object(y.a)(["\n    position:fixed;\n    top:0;\n    left:0;\n    width:100%;\n    height:100%;\n    background:rgba(0,0,0,0.6);\n    z-index:2;\n"]);return H=function(){return e},e}var F=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={auth:!1,token:""},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){localStorage.getItem("access_token")&&this.setState({auth:!0,token:localStorage.getItem("access_token")})}},{key:"render",value:function(){return this.state.auth?null:r.a.createElement(G,null,r.a.createElement(J,{onClick:B.linkButtonClicked},"Log in with Eventbrite to view events"))}}]),t}(r.a.Component),G=w.a.div(H()),J=w.a.button(M()),N=F,V=n(35),W=n(21),X=n(30),Y=n.n(X),$=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"getHeaders",value:function(){var e=localStorage.getItem("access_token");return{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}},{key:"getEvents",value:function(){var e=Object(g.a)(v.a.mark(function e(){var t,n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getHeaders(),n="".concat("https://detrashed-backend.herokuapp.com","/events/get"),e.abrupt("return",b.sendGetRequest(n,t));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"createEvent",value:function(){var e=Object(g.a)(v.a.mark(function e(t,n){var a,r,o;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Y()(n),n=(n=Y.a.utc(n)).format(),a=this.getHeaders(),r="".concat("https://detrashed-backend.herokuapp.com","/events/create"),o={location:{address:{longitude:t.lng,latitude:t.lat},name:t.name,summary:t.summary},start_time:n},e.abrupt("return",b.sendPostRequest(r,o,a));case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function K(){var e=Object(y.a)(["\n    color:red;\n"]);return K=function(){return e},e}function Q(){var e=Object(y.a)([""]);return Q=function(){return e},e}function Z(){var e=Object(y.a)(["\n    width:100%;\n"]);return Z=function(){return e},e}function ee(){var e=Object(y.a)(["\n    position:absolute;\n    top:50%;\n    left:50%;\n    width:60%;\n    transform:translate(-50%, -50%);\n    display:block;\n"]);return ee=function(){return e},e}function te(){var e=Object(y.a)(["\n    position:absolute;\n    width:50px;\n    height:50px;\n    border-radius:50%;\n    background:#eee;\n    border:solid 2px #3e603e;\n    z-index:5;\n    cursor:pointer;\n\n    &:hover {\n        background:#efe;\n    }\n"]);return te=function(){return e},e}function ne(){var e=Object(y.a)(["\n    position:absolute;\n    top:-16px;\n    right:-16px;\n    height:32px;\n    width:32px;\n    background:red;\n    border-radius:50%;\n    border:solid 1px black;\n    color:white;\n    text-align:center;\n    line-height:32px;\n\n    &:after {\n        content: 'X';\n    }\n\n"]);return ne=function(){return e},e}function ae(){var e=Object(y.a)(["\n    width:100%;\n"]);return ae=function(){return e},e}function re(){var e=Object(y.a)(["\n\n    width:300px;\n\n"]);return re=function(){return e},e}function oe(){var e=Object(y.a)(["\n    position:absolute;\n    top:50px;\n    left:150px;\n    z-index:4;\n    padding:15px;\n    color: #3e603e;\n    background: #eee;\n    font-size:20px;\n    border:solid 2px #3e603e;\n    border-radius:5px;\n    cursor:pointer;\n\n    @media (max-width:500px) {\n        bottom:0;\n        width:100%;\n        left:0;\n        top:auto;\n        text-align:center;\n    }\n"]);return oe=function(){return e},e}var ce=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(l.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){n.setState(Object(V.a)({},e.target.name,e.target.value))},n.toggleEvent=function(){n.setState({createOpen:!n.state.createOpen,selecting:!n.state.selecting,confirming:!1})};var a=n.getStartDate();return n.state={createOpen:!1,selecting:!1,confirming:!1,name:"",summary:"",startdate:a,error_message:""},n.Create=n.Create.bind(Object(W.a)(Object(W.a)(n))),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"getStartDate",value:function(){var e=new Date,t=e.getUTCFullYear(),n=r(e.getUTCMonth()),a=r(e.getUTCDate());return"".concat(t,"-").concat(n,"-").concat(a,"T09:00");function r(e){return e<10?"0".concat(e):e}}},{key:"componentDidUpdate",value:function(e){e.mapClicked!==this.props.mapClicked&&this.state.selecting&&this.selectLocation()}},{key:"Create",value:function(){var e=Object(g.a)(v.a.mark(function e(){var t,n,a,r;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.name.length<1)){e.next=3;break}return this.setState({error_message:"Please enter a name for the event"}),e.abrupt("return");case 3:if(!(this.state.summary.length<1)){e.next=6;break}return this.setState({error_message:"Please enter a summary for the event"}),e.abrupt("return");case 6:return(t=this.props.mapClicked.latlng).name=this.state.name,t.summary=this.state.summary,n=this.state.startdate,e.next=12,$.createEvent(t,n);case 12:if(a=e.sent,console.log(a),void 0===a.err){e.next=17;break}return this.setState({error_message:a.err}),e.abrupt("return");case 17:try{(r=a.event).venue=a.venue,this.props.addEvent(r),this.setState({createOpen:!1,selecting:!1,confirming:!1})}catch(o){console.log(o)}case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"selectLocation",value:function(){var e=this;this.setState({confirming:!1}),setTimeout(function(){e.setState({confirming:!0})},500)}},{key:"render",value:function(){if(!this.state.createOpen)return r.a.createElement(ie,{onClick:this.toggleEvent},"Create Event");var e=0,t=0,n="none";return this.props.mapClicked&&this.state.selecting&&(e=this.props.mapClicked.originalEvent.offsetX-25,t=this.props.mapClicked.originalEvent.offsetY-25,n="block"),r.a.createElement(r.a.Fragment,null,r.a.createElement(se,null,r.a.createElement(le,{onClick:this.toggleEvent}),r.a.createElement("h3",null,"Select a location on the map"),r.a.createElement(me,null,this.state.error_message),r.a.createElement(de,{type:"text",name:"name",onChange:this.handleChange,value:this.state.name,placeholder:"Event name"}),r.a.createElement(fe,{name:"summary",onChange:this.handleChange,value:this.state.summary,placeholder:"Event description... consider adding your email or phone number so that interested members can contact you for further details"}),r.a.createElement(ue,{type:"datetime-local",name:"startdate",defaultValue:this.state.startdate,onChange:this.handleChange})),r.a.createElement(pe,{style:{left:"".concat(e,"px"),top:"".concat(t,"px"),display:n}},this.state.confirming&&r.a.createElement(he,{onClick:this.Create,src:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b0/Light_green_check.svg/480px-Light_green_check.svg.png"})))}}]),t}(a.Component),ie=w.a.div(oe()),se=Object(w.a)(ie)(re()),ue=w.a.input(ae()),le=w.a.div(ne()),pe=w.a.div(te()),he=w.a.img(ee()),de=w.a.input(Z()),fe=w.a.textarea(Q()),me=w.a.div(K()),ve=ce;function ge(){var e=Object(y.a)([""]);return ge=function(){return e},e}var be=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={events:[],mapClicked:null},n.addEvent=function(e){var t=Object(x.a)(n.state.events);t.push(e),n.setState({events:t})},n.handleClick=function(e){console.log(e),n.setState({mapClicked:e})},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.getEvents()}},{key:"getEvents",value:function(){var e=Object(g.a)(v.a.mark(function e(){var t,n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.getEvents();case 2:return t=e.sent,e.next=5,t.events;case 5:(n=e.sent)?(console.log(n),this.setState({events:n})):(console.log("NO EVENTS"),localStorage.removeItem("access_token"));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return new URLSearchParams(window.location.search).get("code")?r.a.createElement(j,null):r.a.createElement(ke,null,r.a.createElement(U,{events:this.state.events,handleClick:this.handleClick}),r.a.createElement(ve,{mapClicked:this.state.mapClicked,addEvent:this.addEvent}),r.a.createElement(N,null))}}]),t}(a.Component),ke=w.a.div(ge()),Oe=be,je=function(e){return r.a.createElement("div",null,e.count)},ye=function(e){return console.log("render child two"),r.a.createElement("h3",null,"Hello")},xe=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={count:0},n.handleClick=function(){n.setState({count:n.state.count+1})},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("button",{onClick:this.handleClick},"Click"),r.a.createElement(je,{count:this.state.count}),r.a.createElement(ye,null))}}]),t}(r.a.Component);function we(e){return console.log("/detrashed-frontend"),r.a.createElement(d.a,null,r.a.createElement(f.a,{exact:!0,path:"/detrashed-frontend/",component:Oe}),r.a.createElement(f.a,{path:"/detrashed-frontend/callback",component:j}),r.a.createElement(f.a,{path:"/detrashed-frontend/test",component:xe}))}var Ee=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(we,{props:this.props}))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(i.a,null,r.a.createElement(Ee,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[40,1,2]]]);
//# sourceMappingURL=main.d17e4795.chunk.js.map